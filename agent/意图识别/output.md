# 资产配置智能体系统化方案

这是一份综合了多方模型智慧的最终落地方案。作为LLM委员会主席，我采纳了 Response A 的"槽位分层（L0/L1）体系"，融合了 Response C 的"路由规则矩阵与完整架构"，并吸纳了 Response B 在产品咨询中提出的"角色适配（Role-Based）"核心逻辑。

以下是基于「金融产品经理 + 资深资产配置专家 + 智能体路由设计师」视角的完整系统方案。

## 方案概述

本方案设计了一个中心化编排器（Orchestrator）与五大垂类智能体（Sub-Agents）协作的架构。核心逻辑是："先医后药"——先通过意图识别与槽位填补完成"诊断"，再路由至对应专家智能体开具"处方"。

---

## 🏛️ 第一部分：系统核心架构（意图与路由设计）

### 1. 意图识别体系 (Intent Taxonomy)

编排器首先将用户自然语言映射为以下核心意图，并提取关键信息（Slots）。

- **I_Profile** (画像构建)：风险测评、询问风险偏好、更新财务状况。
- **I_Allocation** (资产配置)：新建组合、资金规划、求方案。
- **I_Rebalance** (调仓/诊断)：持有基金诊断、市场波动应对、止盈止损咨询。
- **I_Market** (市场解读)：宏观分析、热点事件影响、后市看法。
- **I_Product** (产品咨询)：单品分析、同类对比、榜单推荐。
- **I_QA** (通用问答)：基础概念解释、名词科普。

### 2. 槽位信息分层 (Slot Filling Strategy)

为了平衡专业性与用户体验，将关键信息分为两层，执行最小化追问策略。

#### L0 核心槽位（决断能不能给方案）

- **Risk_Tolerance**（风险承受）：最大回撤容忍度 / 风险等级。
- **Time_Horizon**（投资期限）：<1年 / 1-3年 / >3年。
- **Liquidity**（资金性质/流动性）：闲钱 / 紧急备用。

#### L1 辅助槽位（优化方案精准度）

- **Current_Holdings**（现有持仓）。
- **Role_Expectation**（产品角色）：底仓 / 卫星 / 对冲。

### 3. 路由策略总图 (Routing Matrix)

| 用户状态/意图 | 关键槽位 L0 状态 | 路由动作 (Next Agent) | 理由与策略 |
| :--- | :--- | :--- | :--- |
| I_Allocation (求配置) | 缺失 | ➡️ A1 风测画像智能体 | 合规红线：无画像不推荐。执行"最短澄清追问"。 |
| I_Allocation (求配置) | 完整 | ➡️ A2 配置引擎智能体 | 调用模型生成战略配比(SAA)，输出具体清单。 |
| I_Rebalance (求调仓) | 完整 (需L1持仓) | ➡️ A3 市场 + A2 配置 | 复合路由：先A3解构市场归因，再A2测算对组合冲击。 |
| I_Product (问产品) | - | ➡️ A4 产品专家智能体 | 关键逻辑：触发"角色确认"。不直接答好坏，先问"买来做什么"。 |
| I_QA / I_Market | - | ➡️ A5 投教/市场智能体 | 直接调用知识库或资讯API回答。 |

---

## 🚀 第二部分：典型场景落地执行 (Scenario Execution)

以下针对三个核心场景，展示完整的意图判断 → 路由规划 → 交付内容闭环。

### 场景 1：新用户初始配置

**用户输入：** "我有20万闲钱，不想存银行了，想买点基金，怎么配？"

#### 1) 意图判断 + 关键信息

- **意图：** I_Allocation (初始配置)
- **已获信息：** 金额=20万，目标=跑赢银行存款
- **缺失 L0 槽位：** Time_Horizon (期限)、Risk_Tolerance (回撤容忍度)

#### 2) 路由规划

- **路由目标：** A1 风测画像智能体
- **理由：** 用户画像缺失，无法生成负责任的配置方案。需启动"信息补全"流程。

#### 3) 交付内容草案 (最短澄清问句)

> **【用户可见回复】**
> 
> 收到，20万是一笔重要的家庭资产。为了给您定制最合适的方案，我只需要确认 2 个关键点：
> 
> 1. 这笔钱您大概多久不用？（A. 1年内随时要用 B. 1-3年 C. 3年以上）
> 2. 您能接受的最坏情况是？（A. 绝不能亏 B. 能接受-5%以内的小波动 C. 为了高收益能忍受-15%左右的波动）
> 
> 回复选项（如 B、B）即可，我会根据您的回答立刻生成配置方案。

---

### 场景 2：市场波动期（焦虑应对）

**用户输入：** "最近美股跌得好厉害，我的账户都绿了，是不是该止损卖出了？"

#### 1) 意图判断 + 关键信息

- **意图：** I_Market (归因) + I_Rebalance (决策) + Emotion_Panic (情绪安抚)
- **已获信息：** 市场=美股，状态=亏损，诉求=止损咨询
- **缺失 L1 槽位：** Current_Holdings (具体持仓比例)

#### 2) 路由规划

- **路由目标：** A3 市场解读 (先稳住情绪) ➡️ A2 配置引擎 (再给理性建议)
- **理由：** 单纯讲道理用户听不进，单纯给操作建议可能因为持仓不明而误导。
  - **A3：** 提供数据证明下跌是"情绪面"还是"基本面"，进行心理按摩。
  - **A2：** 基于"长期主义"逻辑，若无法获取具体持仓，则给出通用的"再平衡/定投"建议作为兜底。

#### 3) 交付内容草案

> **【用户可见回复】**
> 
> **1. 市场发生了什么？**
> 
> 近期美股波动主要受"加息预期升温"影响，这属于估值修复，而非企业盈利能力出了问题。历史上此类下跌通常是捡便宜筹码的机会。
> 
> **2. 给您的建议：不要恐慌性离场**
> 
> 如果这笔钱是做长期投资（3年以上）的：
> 
> - **不止损：** 现在的下跌是在释放风险，此时卖出就是"实亏"。
> - **做体检：** 请问您目前美股基金占总仓位的比例很高吗？（例如超过40%？）
>   - 若占比不高：建议保持不动，或开启定投摊低成本。
>   - 若占比过高：建议在反弹时适度降低仓位，转入稳健的债券类资产。

---

### 场景 3：具体产品咨询（角色适配）

**用户输入：** "XX科技ETF（515xxx）这个产品怎么样？能不能买？"

#### 1) 意图判断 + 关键信息

- **意图：** I_Product (单品诊断)
- **已获信息：** 标的=515xxx
- **缺失 L1 槽位：** Role_Expectation (它在组合里扮演什么角色)

#### 2) 路由规划

- **路由目标：** A4 产品专家智能体
- **理由：** 【关键策略点】不直接回答"好/坏"。高波动产品对于"想做底仓"的人是毒药，对于"想做卫星仓位"的人可能是良药。必须先澄清角色。

#### 3) 交付内容草案

> **【用户可见回复】**
> 
> 这只科技ETF属于**"高弹性、高波动"的进攻型品种**（近一年最大回撤达-30%）。回答"能不能买"之前，我建议先看它在您组合里的角色：
> 
> - 如果您想把它当"底仓"重仓买入：❌ **不建议**。单一赛道风险过高，容易大起大落，体验很差。
> - 如果您已有宽基打底，想用5%-10%的小资金博取超额收益：✅ **可以考虑**。当前估值适中，适合作为"卫星仓位"分批布局。
> 
> 您是哪种想法？

---

## 💡 给开发者的落地建议 (Implementation Notes)

### 统一中间态 (Structured State)

每轮对话必须产出结构化JSON，包含 `intent`, `confidence`, `current_slots`, `missing_critical_slots`。这是连接LLM与后端金融引擎的桥梁。

```json
{
  "intent": "I_Allocation",
  "confidence": 0.95,
  "current_slots": {
    "amount": 200000,
    "liquidity": "闲钱"
  },
  "missing_critical_slots": ["Time_Horizon", "Risk_Tolerance"]
}
```